# -*- coding: utf-8 -*-
"""filmes ancine notebook

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/18dZHXBCuFQv1Mp7Bq2tjdmW-Nbyq5wcM
"""

# Commented out IPython magic to ensure Python compatibility.
import numpy as np
import pandas as pd
# %matplotlib inline

"""#analise de filmes exibidos no brasil 2009-2017"""

df = pd.read_excel("2120_0.xlsx",skiprows=2,skipfooter=16)
df.head()

df.tail(20)

df.dtypes

#converter campo de data de lancamento em data
df["Data de lançamento"] = pd.to_datetime(df["Data de lançamento"])

#vms tentar identificar o problema da coluna Data de lançamento
df["Data de lançamento"].value_counts()

#exibir algumas filmes com relancamento
df[df["Data de lançamento"] == "Relançamento"].head()

"""## decisao sobre dados incorretos"""

df.shape

#criar um novo dataframe sem os relancamentos
df_novo = df[df["Data de lançamento"] != "Relançamento"].copy() #Make a copy of this object's indices and data.

#convertar data de lancamento para datetime
df_novo["Data de lançamento"] = pd.to_datetime(df_novo["Data de lançamento"])

df_novo.dtypes

#Quais anos tiveram mais filmes lancados?
df_novo['Data de lançamento'].dt.year.value_counts()

#grafico com lancamentos por anos
df_novo['Data de lançamento'].dt.year.value_counts().plot.barh()

#filme com maior bilheteria
df_novo[df_novo['Renda (R$) no ano de exibição'] == df_novo['Renda (R$) no ano de exibição'].max()]

df_novo.nlargest(5,'Renda (R$) no ano de exibição')

df_novo['Nacionalidade da obra'].value_counts()

df_novo.count??