# -*- coding: utf-8 -*-
"""analise_dados_legis

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1H8cw2HMaoHn69yNISFWwoPY0wije6WVq
"""

import pandas as pd
import numpy as np

df= pd.read_csv("BRAZIL_CITIES.csv", sep=";")
df.head()

df.count()

df.describe() #descreve as colunas numericas

df.head()

df["CAPITAL"].value_counts()

df["STATE"].value_counts()

# Commented out IPython magic to ensure Python compatibility.
#mostrar grafico
# %matplotlib inline

df["STATE"].value_counts().plot.bar()
#df["STATE"].value_counts().plot.pie()



df= pd.read_csv("BRAZIL_CITIES_REV2022.CSV", sep=",",usecols=[0,1,2,3])
#mostra apenas algumas colunas

#trocar nome da coluna
df.columns = ["Cidade","Estado","Capital", "Pop IBGE"]
df.head()

df.describe()

df["Capital"].unique()

df["Capital"].value_counts()

df["Estado"].value_counts()

df["Estado"].value_counts().plot.bar()

#subconjunto dos dados originais

df_capitais = df[df['Capital']==1]
df_capitais

# Agrupar pelo nome da cidade e manter apenas a linha com a maior população
df_capitais = df_capitais.groupby('Cidade', as_index=False).max()
#df_capitais["Estado"].count()
df_capitais

df_capitais = df_capitais.sort_values('Pop IBGE', ascending=False)
df_capitais