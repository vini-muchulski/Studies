# -*- coding: utf-8 -*-
"""senado

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1KNxh3sWRGNat1fpO_rV4F10ZOVGOHgpd

# Análise dos dados de senadores - 2023
"""

import pandas as pd
import numpy as np

df = pd.read_csv("despesas_ceaps_2023.csv", sep=";",encoding="utf-8") #decimal=","

display(df)

#verificar tamanho e tipos dos dados
df.info()

df.describe()

#qual o total de reembolsos
df["VALOR_REEMBOLSADO"].sum()

df.head()

df.rename(columns={'MÊS': 'SENADOR'}, inplace=True)
df.rename(columns={'NOME_SENADOR': 'GASTO'}, inplace=True)
df.rename(columns={'ANO': 'MES'}, inplace=True)
df.rename(columns={'TIPO_DOCUMENTO': 'ANO'}, inplace=True)
df.head()

#qnts reembolsos foram solicitados por cada senador

df["SENADOR"].value_counts()

#quanto cada senador solicitou de reembolso em 2023
df.groupby("SENADOR")["VALOR_REEMBOLSADO"].sum().sort_values(ascending=False)

#quais sao os 5 maiores valores de reembolso
df.nlargest(5,"VALOR_REEMBOLSADO")

#quantidade de reembolso por tipos de despesa
df['GASTO'].value_counts()

#qnt foi reembolsado por cada tipo de despesa
df.groupby("GASTO")["VALOR_REEMBOLSADO"].sum().sort_values(ascending=False)